<html lang="nl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PotVolGoesting - Wa eten we vandaag?</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Quicksand:wght@400;600;700&display=swap"
        rel="stylesheet">
    <style>
        /* Bomma Chic Theme & Custom Utilities */
        :root {
            --bomma-red: #d32f2f;
            --bomma-cream: #fdfbf7;
            --bomma-dark: #3e2723;
        }

        body {
            font-family: 'Quicksand', sans-serif;
            background-color: var(--bomma-cream);
            color: var(--bomma-dark);
            /* Subtle kitchen towel pattern */
            background-image:
                linear-gradient(rgba(211, 47, 47, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(211, 47, 47, 0.03) 1px, transparent 1px);
            background-size: 20px 20px;
        }

        .font-bomma {
            font-family: 'Pacifico', cursive;
        }

        .btn-bomma {
            background-color: var(--bomma-red);
            color: white;
            transition: all 0.2s ease-in-out;
            box-shadow: 0 4px 6px rgba(211, 47, 47, 0.2);
        }

        .btn-bomma:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(211, 47, 47, 0.3);
        }

        .btn-bomma:active {
            transform: translateY(0);
        }

        .btn-chaos {
            background-color: #ffb300;
            color: #3e2723;
            box-shadow: 0 4px 6px rgba(255, 179, 0, 0.2);
        }

        .btn-chaos:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(255, 179, 0, 0.3);
        }

        /* Slider styling */
        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            background: transparent;
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 24px;
            width: 24px;
            border-radius: 50%;
            background: var(--bomma-red);
            cursor: pointer;
            margin-top: -8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        input[type=range]::-webkit-slider-runnable-track {
            width: 100%;
            height: 8px;
            cursor: pointer;
            background: #e0e0e0;
            border-radius: 4px;
        }

        /* Animations */
        @keyframes popIn {
            0% {
                opacity: 0;
                transform: scale(0.95) translateY(10px);
            }

            100% {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }

        /* New Pot Animations */
        @keyframes shakePot {

            0%,
            100% {
                transform: translateX(0) rotate(0);
            }

            15% {
                transform: translateX(-4px) rotate(-3deg);
            }

            30% {
                transform: translateX(4px) rotate(3deg);
            }

            45% {
                transform: translateX(-4px) rotate(-2deg);
            }

            60% {
                transform: translateX(4px) rotate(2deg);
            }

            75% {
                transform: translateX(-2px) rotate(-1deg);
            }
        }

        @keyframes flyOff {
            0% {
                transform: translateY(0) rotate(0) scale(1);
                opacity: 1;
            }

            30% {
                transform: translateY(-40px) rotate(-10deg) scale(1.1);
                opacity: 1;
            }

            100% {
                transform: translateY(-300px) rotate(60deg) scale(0.5);
                opacity: 0;
            }
        }

        .animate-pop {
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        .animate-shake {
            animation: shakePot 0.4s ease-in-out infinite;
        }

        .animate-fly-off {
            animation: flyOff 0.7s cubic-bezier(0.25, 1, 0.5, 1) forwards;
            transform-origin: center right;
        }

        .delay-1 {
            animation-delay: 0.1s;
        }

        .delay-2 {
            animation-delay: 0.2s;
        }

        .delay-3 {
            animation-delay: 0.3s;
        }

        .bomma-tip-bubble {
            position: relative;
            background: white;
            border-radius: 1rem;
            border: 2px dashed #ffcc80;
        }

        .bomma-tip-bubble::after {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 20px;
            border-width: 10px;
            border-style: solid;
            border-color: transparent transparent white transparent;
        }
    </style>
</head>

<body class="min-h-screen flex flex-col p-4 md:p-8">

    <!-- Main Container -->
    <main
        class="max-w-md w-full mx-auto bg-white/90 backdrop-blur-sm rounded-3xl shadow-xl overflow-hidden border border-orange-50 flex-grow flex flex-col">

        <!-- Header -->
        <header class="bg-gradient-to-br from-[#d32f2f] to-[#b71c1c] p-6 text-center relative overflow-hidden">
            <div
                class="absolute inset-0 opacity-10 bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCI+PGNpcmNsZSBjeD0iMiIgY3k9IjIiIHI9IjIiIGZpbGw9IiNmZmYiLz48L3N2Zz4=')]">
            </div>
            <h1 class="font-bomma text-4xl text-white mb-2 relative z-10 drop-shadow-md">PotVolGoesting</h1>
            <p class="text-red-100 font-semibold text-lg relative z-10">Wa eten we vandaag, schatteke?</p>
        </header>

        <!-- Controls -->
        <section class="p-6 space-y-6">

            <!-- Health Filter -->
            <div class="space-y-2">
                <div class="flex justify-between items-center">
                    <label for="healthSlider" class="font-bold text-gray-700 flex items-center gap-2">
                        <span>Gezondheidsmeter</span>
                        <span id="healthDisplay"
                            class="bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full font-bold">Zelfs de bomma eet
                            groentjes (5)</span>
                    </label>
                </div>
                <input type="range" id="healthSlider" min="1" max="10" value="5" class="w-full">
                <div class="flex justify-between text-xs text-gray-400 font-bold uppercase">
                    <span>Vettig (1)</span>
                    <span>Gezond (10)</span>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="grid grid-cols-2 gap-3">
                <button id="btnSmart"
                    class="btn-bomma rounded-xl py-4 font-bold text-lg flex flex-col items-center justify-center gap-1">
                    <span class="text-2xl">üç≤</span>
                    <span>Zoek met Goesting</span>
                </button>
                <button id="btnChaos"
                    class="btn-chaos rounded-xl py-4 font-bold text-lg flex flex-col items-center justify-center gap-1 transition-all">
                    <span class="text-2xl">üå™Ô∏è</span>
                    <span>Gij Beslist!</span>
                </button>
            </div>
            <p class="text-center text-xs text-gray-400 italic" id="fridayBanner" style="display: none;">
                üçü 't Is vrijdag! Vandaag extra kans op frietjes!
            </p>
        </section>

        <!-- Results Area -->
        <section class="bg-gray-50 flex-grow p-6 border-t border-gray-100 relative">

            <!-- Initial State -->
            <div id="emptyState"
                class="h-full flex flex-col items-center justify-center text-center text-gray-400 space-y-3 opacity-100 transition-opacity duration-300">
                <span class="text-5xl">üëµüèº</span>
                <p class="text-lg">Druk op een knop om te zien<br>wa we gaan eten!</p>
            </div>

            <!-- Cooking Animation Container (NEW) -->
            <div id="cookingAnimation"
                class="hidden h-full flex-col items-center justify-center text-center absolute inset-0 z-20 bg-gray-50">
                <div class="relative w-64 h-64 mb-4">
                    <svg width="100%" height="100%" viewBox="0 0 100 100" class="overflow-visible" id="potSvg">
                        <!-- Pot Handles -->
                        <circle cx="15" cy="65" r="12" fill="none" stroke="#271815" stroke-width="6" />
                        <circle cx="85" cy="65" r="12" fill="none" stroke="#271815" stroke-width="6" />
                        <!-- Pot Base -->
                        <path d="M 12 48 L 88 48 C 88 95, 12 95, 12 48 Z" fill="#3e2723" />
                        <!-- Pot Lid (Separated for animation) -->
                        <g id="potLid">
                            <!-- Lid Dome -->
                            <path d="M 8 48 C 8 10, 92 10, 92 48 Z" fill="#d32f2f" />
                            <!-- Lid Handle -->
                            <rect x="38" y="8" width="24" height="10" rx="5" fill="#b71c1c" />
                        </g>
                    </svg>
                </div>
                <p class="font-bomma text-2xl text-red-800 animate-pulse">Efkes roeren...</p>
            </div>

            <!-- Meal Container -->
            <div id="mealContainer" class="hidden space-y-4 relative z-10">
                <!-- Dynamically filled by JS -->
            </div>

            <!-- Bomma Tip -->
            <div id="bommaTipContainer" class="hidden mt-6">
                <div class="flex items-start gap-3">
                    <div class="text-4xl shrink-0 mt-2">üëµüèº</div>
                    <div class="bomma-tip-bubble p-4 shadow-sm w-full">
                        <p class="text-sm font-bold text-orange-800 mb-1">De Bomma zegt:</p>
                        <p id="bommaTipText" class="text-gray-700 italic text-sm">"Vergeet uw sauske ni h√®!"</p>
                    </div>
                </div>
            </div>

        </section>
    </main>

    <script>
        // --- DATA SCHEMA (The "Source of Truth") ---
        const recipesDatabase = [
            // PROTEINS
            { id: "p1", name: "Stoofvlees", type: "protein", tags: ["vlaams", "comfort", "winter", "bier"], health_score: 3, is_fry_friendly: true, emoji: "ü•©", bomma_tip: "Gebruik een bruine boterham met mosterd voor de binding, da's een stukske magie." },
            { id: "p2", name: "Gehaktballetjes", type: "protein", tags: ["vlaams", "comfort", "familie", "tomaat"], health_score: 5, is_fry_friendly: true, emoji: "üßÜ", bomma_tip: "Draai uw ballekes ni te groot, dan zijn ze sneller gaar." },
            { id: "p3", name: "Kipfilet", type: "protein", tags: ["vlaams", "licht", "zomer", "snel"], health_score: 8, is_fry_friendly: true, emoji: "üçó", bomma_tip: "Kruid uw kip goed langs beide kanten, een flauwe kip is zonde." },
            { id: "p4", name: "Zalmmoot", type: "protein", tags: ["vis", "licht", "zomer", "chic"], health_score: 9, is_fry_friendly: false, emoji: "üêü", bomma_tip: "Bak uw zalm op het vel voor een krokant korstje." },
            { id: "p5", name: "Vol-au-vent", type: "protein", tags: ["vlaams", "comfort", "familie"], health_score: 4, is_fry_friendly: true, emoji: "ü•ß", bomma_tip: "Zelf bladerdeegkoekskes maken? Ben zot, koop die gewoon bij den bakker!" },
            { id: "p6", name: "Veggie Burger", type: "protein", tags: ["veggie", "snel", "comfort"], health_score: 7, is_fry_friendly: true, emoji: "üçî", bomma_tip: "Die moderne vleesvervangers zijn nog zo slecht ni!" },

            // VEGETABLES
            { id: "v1", name: "Witloof", type: "vegetable", tags: ["vlaams", "winter", "chic", "comfort", "kaas"], health_score: 8, emoji: "ü•¨", bomma_tip: "Haal het bittere poepke uit uw witloof, dan eten de mannen het ook." },
            { id: "v2", name: "Wortelkes & Erwtjes", type: "vegetable", tags: ["vlaams", "familie", "snel"], health_score: 9, emoji: "ü•ï", bomma_tip: "Een klontje goeie boter onder de wortelkes maakt alles beter." },
            { id: "v3", name: "Boontjes", type: "vegetable", tags: ["vlaams", "zomer", "licht"], health_score: 9, emoji: "ü´ò", bomma_tip: "Rol ze in een stukske spek, da lust iedereen." },
            { id: "v4", name: "Appelmoes", type: "vegetable", tags: ["vlaams", "familie", "comfort"], health_score: 6, emoji: "üçè", bomma_tip: "Laat er een stokske kaneel in meekoken, heerlijk!" },
            { id: "v5", name: "Gemsengde Sla", type: "vegetable", tags: ["zomer", "licht", "snel", "vis"], health_score: 10, emoji: "ü•ó", bomma_tip: "Maak uw vinaigrette zelf: wat mosterd, azijn en goeie olie." },

            // CARBOHYDRATES
            { id: "c1", name: "Frietjes", type: "carbohydrate", tags: ["vlaams", "comfort", "familie", "frituur"], health_score: 2, emoji: "üçü", bomma_tip: "Bak ze twee keer: eerst pocheren op 140 graden, dan afbakken op 180." },
            { id: "c2", name: "Gekookte Patatjes", type: "carbohydrate", tags: ["vlaams", "licht", "vis", "zomer"], health_score: 8, emoji: "ü•î", bomma_tip: "Bintjes zijn de beste patatten om te koken, geloof mij." },
            { id: "c3", name: "Aardappelpuree", type: "carbohydrate", tags: ["vlaams", "comfort", "winter"], health_score: 5, emoji: "ü•£", bomma_tip: "Gebruik een pureestamper, genen mixer! Anders krijgt ge lijm." },
            { id: "c4", name: "Kroketjes", type: "carbohydrate", tags: ["vlaams", "chic", "comfort", "winter"], health_score: 3, emoji: "üßÜ", bomma_tip: "Kroketjes zijn voor de zondag, of als er volk komt!" },
            { id: "c5", name: "Pasta", type: "carbohydrate", tags: ["snel", "familie", "tomaat"], health_score: 6, emoji: "üçù", bomma_tip: "Kook uw pasta in water dat zo zout is als de zee." },

            // FULL DISHES (Takes 3 columns)
            { id: "f1", name: "Macaroni met Kaas en Hesp", type: "full_dish", tags: ["vlaams", "comfort", "familie", "oven"], health_score: 3, emoji: "üßÄ", bomma_tip: "Kruid uw kaassaus met v√©√©l nootmuskaat, da's de truc." },
            { id: "f2", name: "Witloof in den Oven", type: "full_dish", tags: ["vlaams", "winter", "comfort", "kaas"], health_score: 4, emoji: "ü•ò", bomma_tip: "Giet het vocht van het witloof af voor ge uw saus erover doet, anders wordt het soep." },
            { id: "f3", name: "Lasagne", type: "full_dish", tags: ["familie", "oven", "comfort"], health_score: 5, emoji: "üáÆüáπ", bomma_tip: "Den dag erna is lasagne n√≥g beter!" }
        ];

        // --- APP LOGIC ---
        const DOM = {
            slider: document.getElementById('healthSlider'),
            healthDisplay: document.getElementById('healthDisplay'),
            btnSmart: document.getElementById('btnSmart'),
            btnChaos: document.getElementById('btnChaos'),
            emptyState: document.getElementById('emptyState'),
            mealContainer: document.getElementById('mealContainer'),
            bommaTipContainer: document.getElementById('bommaTipContainer'),
            bommaTipText: document.getElementById('bommaTipText'),
            fridayBanner: document.getElementById('fridayBanner'),
            // New DOM elements for animation
            cookingAnimation: document.getElementById('cookingAnimation'),
            potSvg: document.getElementById('potSvg'),
            potLid: document.getElementById('potLid')
        };

        // Friday Logic
        const isFriday = new Date().getDay() === 5;
        if (isFriday) {
            DOM.fridayBanner.style.display = 'block';
        }

        // Health slider display updates
        DOM.slider.addEventListener('input', (e) => {
            const val = parseInt(e.target.value);
            let text = "";
            if (val <= 3) text = `Lekker vettig (${val})`;
            else if (val <= 6) text = `Goe gebalanceerd (${val})`;
            else text = `Super gezond (${val})`;
            DOM.healthDisplay.textContent = text;
        });

        // Event Listeners for Buttons
        DOM.btnSmart.addEventListener('click', () => generateMeal(false));
        DOM.btnChaos.addEventListener('click', () => generateMeal(true));

        function getCombinations(minHealth, isChaos) {
            let validCombos = [];
            const proteins = recipesDatabase.filter(d => d.type === 'protein');
            const veggies = recipesDatabase.filter(d => d.type === 'vegetable');
            const carbs = recipesDatabase.filter(d => d.type === 'carbohydrate');
            const fullDishes = recipesDatabase.filter(d => d.type === 'full_dish');

            // 1. Check Full Dishes
            fullDishes.forEach(dish => {
                if (dish.health_score >= minHealth) {
                    validCombos.push({ type: 'full', items: [dish] });
                }
            });

            // 2. Check 3-Piece Combos
            proteins.forEach(p => {
                veggies.forEach(v => {
                    carbs.forEach(c => {
                        const avgHealth = (p.health_score + v.health_score + c.health_score) / 3;

                        if (avgHealth >= minHealth) {
                            if (isChaos) {
                                // Chaos mode: just add it, no tag checking
                                validCombos.push({ type: 'combo', items: [p, v, c] });
                            } else {
                                // Smart Match: Must share at least 1 tag across the entire meal
                                // Or at least: Protein matches Veggie AND Protein matches Carb
                                const pTags = new Set(p.tags);
                                const vTags = new Set(v.tags);
                                const cTags = new Set(c.tags);

                                // Find a tag that exists in all three
                                const sharedTagsAll = [...pTags].filter(x => vTags.has(x) && cTags.has(x));

                                // Relaxed smart match: If P matches V, and V matches C, or P matches C.
                                // Let's say: The meal must have at least one overarching theme (tag shared by at least 2 items)
                                const sharedPV = [...pTags].filter(x => vTags.has(x));
                                const sharedPC = [...pTags].filter(x => cTags.has(x));
                                const sharedVC = [...vTags].filter(x => cTags.has(x));

                                if (sharedTagsAll.length > 0 || sharedPV.length > 0 || sharedPC.length > 0 || sharedVC.length > 0) {
                                    validCombos.push({ type: 'combo', items: [p, v, c] });
                                }
                            }
                        }
                    });
                });
            });

            return validCombos;
        }

        function generateMeal(isChaos) {
            const minHealth = parseInt(DOM.slider.value);
            let combos = getCombinations(minHealth, isChaos);

            if (combos.length === 0) {
                alert("Oei schatteke! De bomma vindt geen recept dat zo gezond (of ongezond) is met deze regels. Pas de meter efkes aan!");
                return;
            }

            // Apply Friday Rule
            if (isFriday) {
                // Find combos that contain Fries or fry-friendly items
                const fridayCombos = combos.filter(combo =>
                    combo.items.some(i => i.name === 'Frietjes' || i.is_fry_friendly)
                );
                // 70% chance to force a friday-friendly meal if available
                if (fridayCombos.length > 0 && Math.random() < 0.7) {
                    combos = fridayCombos;
                }
            }

            // Pick a random combination
            const selectedCombo = combos[Math.floor(Math.random() * combos.length)];

            // Trigger Animation Flow instead of rendering immediately
            playCookingAnimation(() => {
                renderMeal(selectedCombo);
                showBommaTip(selectedCombo.items);
            });
        }

        function playCookingAnimation(onComplete) {
            // Hide everything else
            DOM.emptyState.classList.add('hidden');
            DOM.mealContainer.classList.add('hidden');
            DOM.bommaTipContainer.classList.add('hidden');

            // Show pot and reset states
            DOM.cookingAnimation.classList.remove('hidden');
            DOM.cookingAnimation.classList.add('flex');
            DOM.potLid.classList.remove('animate-fly-off');
            DOM.potSvg.classList.add('animate-shake');

            // Phase 1: Cooking / Shaking
            setTimeout(() => {
                DOM.potSvg.classList.remove('animate-shake'); // Stop shaking
                DOM.potLid.classList.add('animate-fly-off');  // Lid flies off

                // Phase 2: Wait for lid to clear screen, then show meals
                setTimeout(() => {
                    DOM.cookingAnimation.classList.add('hidden');
                    DOM.cookingAnimation.classList.remove('flex');
                    onComplete(); // Call render logic
                }, 600); // 600ms matches the flyOff animation duration closely

            }, 1200); // Shake for 1.2 seconds
        }

        function renderMeal(combo) {
            DOM.emptyState.classList.add('hidden');
            DOM.mealContainer.classList.remove('hidden');
            DOM.mealContainer.innerHTML = ''; // Clear previous

            if (combo.type === 'full') {
                // Render single wide card
                const item = combo.items[0];
                DOM.mealContainer.innerHTML = createCardHTML(item, "Hoofdgerecht", "delay-1", true);
            } else {
                // Render 3 slots
                const [protein, veggie, carb] = combo.items;
                DOM.mealContainer.innerHTML = `
                    <div class="space-y-3">
                        ${createCardHTML(protein, "Vlees/Vis/Veggie", "delay-1")}
                        ${createCardHTML(veggie, "Groentjes", "delay-2")}
                        ${createCardHTML(carb, "Patatjes/Pasta", "delay-3")}
                    </div>
                `;
            }
        }

        function createCardHTML(item, label, animationDelay, isFullDish = false) {
            const scoreColor = item.health_score > 6 ? 'text-green-600 bg-green-50 border-green-200' :
                (item.health_score > 3 ? 'text-orange-600 bg-orange-50 border-orange-200' : 'text-red-600 bg-red-50 border-red-200');

            return `
                <div class="bg-white rounded-2xl p-4 shadow-sm border border-gray-100 flex items-center gap-4 animate-pop opacity-0 ${animationDelay} transition-all hover:shadow-md hover:border-orange-200">
                    <div class="text-4xl bg-orange-50 w-16 h-16 rounded-xl flex items-center justify-center shrink-0 border border-orange-100 shadow-inner">
                        ${item.emoji}
                    </div>
                    <div class="flex-grow">
                        <p class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-1">${label}</p>
                        <h3 class="text-xl font-bold text-gray-800">${item.name}</h3>
                        <div class="flex flex-wrap gap-1 mt-1">
                            ${item.tags.map(tag => `<span class="text-[10px] px-2 py-0.5 bg-gray-100 text-gray-500 rounded-full font-semibold uppercase">#${tag}</span>`).join('')}
                        </div>
                    </div>
                    <div class="shrink-0 flex flex-col items-center justify-center w-12 h-12 rounded-full border-2 ${scoreColor}">
                        <span class="text-xs font-bold">Gez.</span>
                        <span class="font-black leading-none">${item.health_score}</span>
                    </div>
                </div>
            `;
        }

        function showBommaTip(items) {
            // Collect all tips from the selected items
            const tips = items.map(i => i.bomma_tip).filter(t => t);

            if (tips.length > 0) {
                // Pick a random tip from the selection
                const randomTip = tips[Math.floor(Math.random() * tips.length)];
                DOM.bommaTipText.textContent = `"${randomTip}"`;

                DOM.bommaTipContainer.classList.remove('hidden');
                DOM.bommaTipContainer.classList.add('animate-pop');
                // Reset animation
                DOM.bommaTipContainer.style.animation = 'none';
                DOM.bommaTipContainer.offsetHeight; /* trigger reflow */
                DOM.bommaTipContainer.style.animation = null;
            } else {
                DOM.bommaTipContainer.classList.add('hidden');
            }
        }
    </script>
</body>

</html>